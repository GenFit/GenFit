16c16
< *                 =  2  : HETC/SKALE has been called               *
---
> *                 =  2  : HETC SKALE has been called               *
250c250
<               CALL GDECAY
---
>               CALL G3DECAY
408,409c408,410
<             CALL AZIRN(SINA,COSA)
<             COSP = SFLRAF(DUM)
---
>             CALL AZIRN2(SINA,COSA)
> 
>             COSP = SFLRAF2(DUM)
718c719
<          CALL GFPART(IPID(I),NAP,ITR,AM,CH,TL,UB,NW)
---
>          CALL G3FPART(IPID(I),NAP,ITR,AM,CH,TL,UB,NW)
736c737
<             CALL GETENV('CERN_ROOT',CHROOT)
---
>             CALL GETENVF('G3SYS',CHROOT)
738c739
<             IF(LNROOT.GT.0)BERTF = CHROOT(1:LNROOT)//'/lib/chetc.dat'
---
>             IF(LNROOT.GT.0)BERTF = CHROOT(1:LNROOT)//'/data/chetc.dat'
1027c1028
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
1036c1037
<          X2 = SNGL(RANDC(ISEED))
---
>          X2 = SNGL(RANDC2(ISEED))
1058c1059
<       SUBROUTINE AZIRN(SIN,COS)
---
>       SUBROUTINE AZIRN2(SIN,COS)
1060c1061
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
1063c1064
<    10 R1 = SFLRAF(DUM)
---
>    10 R1 = SFLRAF2(DUM)
1065c1066
<       R2 = RANDC(ISEED)
---
>       R2 = RANDC2(ISEED)
1227c1228
<       FUNCTION EXPRNF(A)
---
>       FUNCTION EXPRNF2(A)
1230c1231
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
1236c1237
<    10 X = RANDC(ISEED)
---
>    10 X = RANDC2(ISEED)
1238c1239
<    20 Y = RANDC(ISEED)
---
>    20 Y = RANDC2(ISEED)
1240c1241
<    30 Z = RANDC(ISEED)
---
>    30 Z = RANDC2(ISEED)
1244c1245
<    50 EXPRNF = X + I
---
>    50 EXPRNF2 = X + I
1252c1253
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
1255,1256c1256,1257
<    10 Y = EXPRNF(X1)
<       Z = EXPRNF(X2)
---
>    10 Y = EXPRNF2(X1)
>       Z = EXPRNF2(X2)
1259c1260
<    20 R1 = 2.0 * RANDC(ISEED) - 1.0
---
>    20 R1 = 2.0 * RANDC2(ISEED) - 1.0
1392c1393
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
1544c1545
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
1720c1721
<  1100 VALUE1 = RANDC(ISEED)
---
>  1100 VALUE1 = RANDC2(ISEED)
1753c1754
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
1872c1873
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
2185c2186
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
2210c2211
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2219c2220
<    40 UNIV = RANDC(ISEED)
---
>    40 UNIV = RANDC2(ISEED)
2238c2239
<   170 UNIV = RANDC(ISEED)
---
>   170 UNIV = RANDC2(ISEED)
2244c2245
<   210 UNIV = RANDC(ISEED)
---
>   210 UNIV = RANDC2(ISEED)
2258c2259
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
2283c2284
<       R = RANDC(ISEED)
---
>       R = RANDC2(ISEED)
2287c2288
<       R = RANDC(ISEED)
---
>       R = RANDC2(ISEED)
2303c2304
<   120 R = RANDC(ISEED)
---
>   120 R = RANDC2(ISEED)
2307c2308
<   150 R = RANDC(ISEED)
---
>   150 R = RANDC2(ISEED)
2315c2316
<   210 R = RANDC(ISEED)
---
>   210 R = RANDC2(ISEED)
2328c2329
<   270 R = RANDC(ISEED)
---
>   270 R = RANDC2(ISEED)
2347c2348
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
2372c2373
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2380c2381
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2407c2408
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2415c2416
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2426c2427
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2433c2434
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
2449c2450
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
2496c2497
<    30 R = RANDC(ISEED)
---
>    30 R = RANDC2(ISEED)
2509c2510
<    50 R = RANDC(ISEED)
---
>    50 R = RANDC2(ISEED)
2512c2513
<    60 R = RANDC(ISEED)
---
>    60 R = RANDC2(ISEED)
2706c2707
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
2743c2744
<    30 VALUE2 = RANDC(ISEED)
---
>    30 VALUE2 = RANDC2(ISEED)
2757c2758
<       COM1 = RANDC(ISEED)
---
>       COM1 = RANDC2(ISEED)
2943c2944
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
2982c2983
<    50 SN = RANDC(ISEED)
---
>    50 SN = RANDC2(ISEED)
2998c2999
<       COM1 = RANDC(ISEED)
---
>       COM1 = RANDC2(ISEED)
3031c3032
<       SN = RANDC(ISEED)
---
>       SN = RANDC2(ISEED)
3036c3037
<   210 VALUE1 = RANDC(ISEED)
---
>   210 VALUE1 = RANDC2(ISEED)
3174c3175
<       FUNCTION SFLRAF(X)
---
>       FUNCTION SFLRAF2(X)
3177c3178
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
3180,3181c3181,3182
<       SFLRAF = 2.0 * RANDC(ISEED)
<       TEMP = 1.0 - SFLRAF
---
>       SFLRAF2 = 2.0 * RANDC2(ISEED)
>       TEMP = 1.0 - SFLRAF2
3183c3184
<    10 SFLRAF = TEMP
---
>    10 SFLRAF2 = TEMP
3323c3324
< C process intranuclear-cascade and evaporation
---
> C process intranuclear2-cascade and evaporation
3431c3432
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
3477c3478
< C --------- start of intranuclear cascade ----------------------
---
> C --------- start of intranuclear2 cascade ----------------------
3480c3481
<       R = RANDC(ISEED)
---
>       R = RANDC2(ISEED)
3518c3519
<          R = RANDC(ISEED)
---
>          R = RANDC2(ISEED)
3523c3524
<          R = RANDC(ISEED)
---
>          R = RANDC2(ISEED)
3539c3540
<          R = RANDC(ISEED)
---
>          R = RANDC2(ISEED)
3740c3741
< C get particles from intranuclear cascade
---
> C get particles from intranuclear2 cascade
3765c3766
<                CALL GTISO(ALP,BET,CAM)
---
>                CALL GTISO2(ALP,BET,CAM)
3779c3780
<                CALL GTISO(ALP,BET,CAM)
---
>                CALL GTISO2(ALP,BET,CAM)
3795c3796
<                   CALL GTISO(ALP,BET,CAM)
---
>                   CALL GTISO2(ALP,BET,CAM)
3808c3809
<             EGAM = EEX * RANDC(ISEED)
---
>             EGAM = EEX * RANDC2(ISEED)
3814,3815c3815,3816
<             CALL AZIRN(SINA,COSA)
<             COSP = SFLRAF(DUM)
---
>             CALL AZIRN2(SINA,COSA)
>             COSP = SFLRAF2(DUM)
3835c3836
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
3878c3879
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
3893c3894
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
3936c3937
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
3945c3946
<    40 UNIV = RANDC(ISEED)
---
>    40 UNIV = RANDC2(ISEED)
3964c3965
<   170 UNIV = RANDC(ISEED)
---
>   170 UNIV = RANDC2(ISEED)
3970c3971
<   210 UNIV = RANDC(ISEED)
---
>   210 UNIV = RANDC2(ISEED)
4020c4021
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
4026c4027
<       R = RANDC(ISEED)
---
>       R = RANDC2(ISEED)
4030c4031
<       R = RANDC(ISEED)
---
>       R = RANDC2(ISEED)
4046c4047
<   120 R = RANDC(ISEED)
---
>   120 R = RANDC2(ISEED)
4050c4051
<   150 R = RANDC(ISEED)
---
>   150 R = RANDC2(ISEED)
4058c4059
<   210 R = RANDC(ISEED)
---
>   210 R = RANDC2(ISEED)
4071c4072
<   270 R = RANDC(ISEED)
---
>   270 R = RANDC2(ISEED)
4126c4127
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
4130c4131
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
4138c4139
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
4165c4166
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
4173c4174
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
4184c4185
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
4191c4192
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
4243c4244
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
4269c4270
<    30 R = RANDC(ISEED)
---
>    30 R = RANDC2(ISEED)
4282c4283
<    50 R = RANDC(ISEED)
---
>    50 R = RANDC2(ISEED)
4285c4286
<    60 R = RANDC(ISEED)
---
>    60 R = RANDC2(ISEED)
4303c4304
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
4307c4308
<    10 R1 = RANDC(ISEED)
---
>    10 R1 = RANDC2(ISEED)
4310c4311
<       R2 = RANDC(ISEED)
---
>       R2 = RANDC2(ISEED)
4321c4322
<       R1 = RANDC(ISEED)
---
>       R1 = RANDC2(ISEED)
4422c4423
<    70 CALLP1CLI
---
>    70 CALL P1CLI
4438c4439
< C        Finput(4) = energy cut off used in intranuclear cascade default = 0
---
> C        Finput(4) = energy cut off used in intranuclear2 cascade default = 0
4459c4460
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
4842c4843
<  1000 CALLROUT11(PPDC(1))
---
>  1000 CALL ROUT11(PPDC(1))
4859c4860
<       CALLROUT13
---
>       CALL ROUT13
4873c4874
<  1160 CALLROUT14
---
>  1160 CALL ROUT14
4884c4885
<  1210 CALLROUT15(PPDC(1))
---
>  1210 CALL ROUT15(PPDC(1))
4907c4908
<  1280 CALLROUT16(PMDD(1))
---
>  1280 CALL ROUT16(PMDD(1))
5093c5094
<  2210 CALLROUT22(PPAC(1),POAC(1),PNEC(1),PMXC(1),PNNEC(1))
---
>  2210 CALL ROUT22(PPAC(1),POAC(1),PNEC(1),PMXC(1),PNNEC(1))
5106c5107
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
5187c5188
<  2570 CALLCBOVER(VALUE2,DNCMS,ANS)
---
>  2570 CALL CBOVER(VALUE2,DNCMS,ANS)
5305c5306
<  3040 CALLSIGNEX
---
>  3040 CALL SIGNEX
5534,5535c5535,5536
<       CALLCBBBBB
<   140 CALLCAISOM
---
>       CALL CBBBBB
>   140 CALL CAISOM
5648c5649
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
5656c5657
<          C = RANDC(ISEED)
---
>          C = RANDC2(ISEED)
6038c6039
<       CALLPSTOR
---
>       CALL PSTOR
6161c6162
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
6178c6179
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
6225c6226
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
6238c6239
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
6255c6256
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
6263c6264
<       UNIV = RANDC(ISEED)
---
>       UNIV = RANDC2(ISEED)
6350c6351
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
6371c6372
<       R = RANDC(ISEED)
---
>       R = RANDC2(ISEED)
6379c6380
<    70 R = RANDC(ISEED)
---
>    70 R = RANDC2(ISEED)
6395c6396
<   150 R = RANDC(ISEED)
---
>   150 R = RANDC2(ISEED)
6746c6747
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
6752c6753
<    10 EXPA = RANDC(ISEED)
---
>    10 EXPA = RANDC2(ISEED)
6754c6755
<    20 EXPB = RANDC(ISEED)
---
>    20 EXPB = RANDC2(ISEED)
6759c6760
<    40 EXPA = RANDC(ISEED)
---
>    40 EXPA = RANDC2(ISEED)
6768c6769
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
6775c6776
<    10 G(I) = RANDC(ISEED)
---
>    10 G(I) = RANDC2(ISEED)
7243c7244
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
7248c7249
<       SINE= RANDC(ISEED)
---
>       SINE= RANDC2(ISEED)
7639c7640
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
7644,7645c7645,7646
<       CS = RANDC(ISEED)
<       S = 2.0 * RANDC(ISEED) - 1.0
---
>       CS = RANDC2(ISEED)
>       S = 2.0 * RANDC2(ISEED) - 1.0
7861c7862
<       DOUBLE PRECISION FUNCTION RANDC(DUMMY)
---
>       DOUBLE PRECISION FUNCTION RANDC2(DUMMY)
7867c7868
<       RANDC = RND1(1)
---
>       RANDC2 = RND1(1)
8104c8105
<    50 CALLSIGNEX
---
>    50 CALL SIGNEX
8181c8182
<    80 CALLPINST
---
>    80 CALL PINST
8213c8214
<   270 CALLCAPUNP
---
>   270 CALL CAPUNP
8270c8271
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
8289c8290
<   100 VALUE1 = RANDC(ISEED)
---
>   100 VALUE1 = RANDC2(ISEED)
8293c8294
<       VALUE1= RANDC(ISEED)
---
>       VALUE1= RANDC2(ISEED)
8295c8296
<   120 VALUE1 = RANDC(ISEED)
---
>   120 VALUE1 = RANDC2(ISEED)
8303c8304
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
8370c8371
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
8424c8425
<    20 VALUE2 = RANDC(ISEED)
---
>    20 VALUE2 = RANDC2(ISEED)
8438c8439
<       COM1 = RANDC(ISEED)
---
>       COM1 = RANDC2(ISEED)
8441c8442
<    50 CALLCANGID
---
>    50 CALL CANGID
8541c8542
<       CALLCALIDK
---
>       CALL CALIDK
8663c8664
<       CALLPSTOR
---
>       CALL PSTOR
8749c8750
<       CALLCRDET(5,T(1),VALUE1)
---
>       CALL CRDET(5,T(1),VALUE1)
8755c8756
<   130 CALLCRDET(5,B(1),RLKE)
---
>   130 CALL CRDET(5,B(1),RLKE)
8800c8801
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
8856c8857
<    40 SN = RANDC(ISEED)
---
>    40 SN = RANDC2(ISEED)
8876c8877
<       COM1 = RANDC(ISEED)
---
>       COM1 = RANDC2(ISEED)
8911c8912
<       CALLCRDET(1,Y(1),VALUE1)
---
>       CALL CRDET(1,Y(1),VALUE1)
8913c8914
<       SN = RANDC(ISEED)
---
>       SN = RANDC2(ISEED)
8918c8919
<   180 VALUE1 = RANDC(ISEED)
---
>   180 VALUE1 = RANDC2(ISEED)
8925c8926
<   210 CALLCANGID
---
>   210 CALL CANGID
9020c9021
<   140 CALLDFMAX
---
>   140 CALL DFMAX
9025c9026
<   170 CALLCSTORE
---
>   170 CALL CSTORE
9027c9028
<       CALLSIGNEX
---
>       CALL SIGNEX
9032c9033
<       CALLPFMAX
---
>       CALL PFMAX
9038c9039
<       CALLCALNNN
---
>       CALL CALNNN
9057c9058
< C     REACTION ALSO ALL CASCADE NUCLEAR REJECTIONS INCLUDING CRJAB OR
---
> C     REACTION ALSO ALL CASCADE NUCLEAR2 REJECTIONS INCLUDING CRJAB OR
9060c9061
<   290 CALLCCPES
---
>   290 CALL CCPES
9066c9067
<   320 CALLCBG6CA(3,0)
---
>   320 CALL CBG6CA(3,0)
9098c9099
<   450 CALLCBG6CA(1,0)
---
>   450 CALL CBG6CA(1,0)
9115c9116
<   510 CALLCBG6CA(2,0)
---
>   510 CALL CBG6CA(2,0)
9179c9180
<   790 CALLCASPCN
---
>   790 CALL CASPCN
9184c9185
<   820 CALLCRDET(1,V(1),COM)
---
>   820 CALL CRDET(1,V(1),COM)
9219c9220
<       CALLCASPCN
---
>       CALL CASPCN
9286c9287
<  1340 CALLCBOVER(CURR(2),PNMS,ANS)
---
>  1340 CALL CBOVER(CURR(2),PNMS,ANS)
9295c9296
<       CALLCRDET(1,V(1),COM)
---
>       CALL CRDET(1,V(1),COM)
9300c9301
<  1350 CALLCRDET(1,W(1),COM)
---
>  1350 CALL CRDET(1,W(1),COM)
9304c9305
<  1370 CALLCBG6CA(3,4)
---
>  1370 CALL CBG6CA(3,4)
9313c9314
<  1410 CALLCBG6CA(2,3)
---
>  1410 CALL CBG6CA(2,3)
9324c9325
<  1480 CALLCBG6CA(1,2)
---
>  1480 CALL CBG6CA(1,2)
9328c9329
<  1500 CALLCBOVER(CURR(2),POMS,ANS)
---
>  1500 CALL CBOVER(CURR(2),POMS,ANS)
9338c9339
<       CALLCRDET(1,W(1),COM)
---
>       CALL CRDET(1,W(1),COM)
9348c9349
<  1530 CALLCRJAB(1,X(1))
---
>  1530 CALL CRJAB(1,X(1))
9352c9353
<  1550 CALLCRJAB(1,Y(1))
---
>  1550 CALL CRJAB(1,Y(1))
9356c9357
<  1570 CALLCRJAB(1,Z(1))
---
>  1570 CALL CRJAB(1,Z(1))
9532c9533
<    20 CALLCRDET(1,T(1),EINC)
---
>    20 CALL CRDET(1,T(1),EINC)
9762c9763
<    30 CALLCRJAB(1,R(1))
---
>    30 CALL CRJAB(1,R(1))
9770c9771
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
9817c9818
<       VALUE1 = RANDC(ISEED)
---
>       VALUE1 = RANDC2(ISEED)
9902c9903
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
9962c9963
<    60 VALUE1 = RANDC(ISEED)
---
>    60 VALUE1 = RANDC2(ISEED)
9979c9980
<   120 CALLP1CLC
---
>   120 CALL P1CLC
9981c9982
<   130 CALLP1CLI
---
>   130 CALL P1CLI
10029c10030
<       CALLSPISOM
---
>       CALL SPISOM
10250,10251c10251,10252
<    90 CALLCABG6B
<       CALLSIGNEX
---
>    90 CALL CABG6B
>       CALL SIGNEX
10307c10308
<    30 CALLCBOVER(WK,UNIV,UNIVE)
---
>    30 CALL CBOVER(WK,UNIV,UNIVE)
10735c10736
<    50    CALLCASTPL(PT(K-2))
---
>    50    CALL CASTPL(PT(K-2))
10741c10742
<    80    CALLCASTPH(PT(K-1))
---
>    80    CALL CASTPH(PT(K-1))
10789c10790
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
10812,10813c10813,10814
<    30 RAN1 = RANDC(ISEED)
<       RAN2 = RANDC(ISEED)
---
>    30 RAN1 = RANDC2(ISEED)
>       RAN2 = RANDC2(ISEED)
10839c10840
<    70 FRAND = RANDC(ISEED)
---
>    70 FRAND = RANDC2(ISEED)
11068c11069
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
11253c11254
<   500 URAN = RANDC(ISEED) * SIGMA
---
>   500 URAN = RANDC2(ISEED) * SIGMA
11274,11275c11275,11276
<   580 E1=EXPRNF(V)/2.0
<       E2=EXPRNF(V)/2.0
---
>   580 E1=EXPRNF2(V)/2.0
>       E2=EXPRNF2(V)/2.0
11277,11278c11278,11279
<       COSCM = RANDC(ISEED)
<       PLORMI = RANDC(ISEED)
---
>       COSCM = RANDC2(ISEED)
>       PLORMI = RANDC2(ISEED)
11325c11326
<       COSCM = RANDC(ISEED)
---
>       COSCM = RANDC2(ISEED)
11467c11468
<       SUBROUTINE GTISO(U,V,W)
---
>       SUBROUTINE GTISO2(U,V,W)
11470c11471
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
11473,11475c11474,11476
<    10 Z = RANDC(ISEED)
<       X = 0.687368 * SFLRAF(X)
<       Y = 0.687368 * SFLRAF(X)
---
>    10 Z = RANDC2(ISEED)
>       X = 0.687368 * SFLRAF2(X)
>       Y = 0.687368 * SFLRAF2(X)
11751a11753
> C      print *,'*************** calling calsig ************ '
11923c11925
<          SIG = SIGMOR(EK,NCEL)
---
>          SIG = SIGMOR2(EK,NCEL)
12025c12027
<       FUNCTION SIGMOR(EK,NMED)
---
>       FUNCTION SIGMOR2(EK,NMED)
12068,12069c12070,12071
<       CALL NSIGTA(EK,NMED,TSIG,D,LD(LFP32),LD(LFP33))
<       SIGMOR = TSIG
---
>       CALL NSIGTA2(EK,NMED,TSIG,D,LD(LFP32),LD(LFP33))
>       SIGMOR2 = TSIG
12074c12076
<       SUBROUTINE ANGCDF(D,LD,LZ)
---
>       SUBROUTINE ANGCDF2(D,LD,LZ)
12110c12112
<       SUBROUTINE BANKR(D,LD,NBNKID)
---
>       SUBROUTINE BANKR2(D,LD,NBNKID)
12175c12177
<       SUBROUTINE BARIER(KZ1,KZ2,A1,A2,CB)
---
>       SUBROUTINE BARIER2(KZ1,KZ2,A1,A2,CB)
12202c12204
<       FUNCTION CADIG(E)
---
>       FUNCTION CADIG2(E)
12207c12209
<       CADIG=1./EPS
---
>       CADIG2=1./EPS
12212c12214
<       SUBROUTINE CANGLE(D,LD,E,FM,LEN)
---
>       SUBROUTINE CANGLE2(D,LD,E,FM,LEN)
12239c12241
< C       THE INTERPOLATION SCHEME IS ASSUMED LINEAR-LINEAR IF IT
---
> C       THE INTERP2OLATION SCHEME IS ASSUMED LINEAR-LINEAR IF IT
12244c12246
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12257c12259
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12272c12274
<       SUBROUTINE CEVAP(E,Q,ATAR,CB,EX)
---
>       SUBROUTINE CEVAP2(E,Q,ATAR,CB,EX)
12302c12304
< C       CALCULATE THE NUCLEAR TEMPERATURE (THETA)
---
> C       CALCULATE THE NUCLEAR2 TEMPERATURE (THETA)
12305,12306c12307,12308
<    20 R1=FLTRNF(0)
<       R2=FLTRNF(0)
---
>    20 R1=FLTRNF2(0)
>       R2=FLTRNF2(0)
12312c12314
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12319c12321
<       SUBROUTINE CEVAP1(EOLD,E,Q,ATAR,CB,EX)
---
>       SUBROUTINE CEVAP21(EOLD,E,Q,ATAR,CB,EX)
12343c12345
< C       CALCULATE THE NUCLEAR TEMPERATURE (THETA)
---
> C       CALCULATE THE NUCLEAR2 TEMPERATURE (THETA)
12347,12348c12349,12350
<    20 R1=FLTRNF(0)
<       R2=FLTRNF(0)
---
>    20 R1=FLTRNF2(0)
>       R2=FLTRNF2(0)
12353c12355
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12361c12363
<       SUBROUTINE CHKZEB(NW,IX)
---
>       SUBROUTINE CHKZEB2(NW,IX)
12386c12388
<       SUBROUTINE CLEAR(L,L1,L2)
---
>       SUBROUTINE CLEAR2(L,L1,L2)
12397c12399
<       SUBROUTINE CMLABE(D,LD,AWR,KZ,ID,FM,Q,IFLG)
---
>       SUBROUTINE CMLABE2(D,LD,AWR,KZ,ID,FM,Q,IFLG)
12454c12456
<       CALL AZIRN(SINETA,COSETA)
---
>       CALL AZIRN2(SINETA,COSETA)
12523c12525
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
12528c12530
<       SUBROUTINE CMLABI(D,LD,AWR,KZ,ID,FM,Q,IFLG,LIFLAG,LRI)
---
>       SUBROUTINE CMLABI2(D,LD,AWR,KZ,ID,FM,Q,IFLG,LIFLAG,LRI)
12583c12585
< C re-sample in COLISN E1<0.0 (Q-value = -EOLD) !!!
---
> C re-sample in COLISN2 E1<0.0 (Q-value = -EOLD) !!!
12595c12597
<       CALL AZIRN(SINETA,COSETA)
---
>       CALL AZIRN2(SINETA,COSETA)
12669c12671
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
12674c12676
<       SUBROUTINE COLISN(D,LD,IGAMS,LGAM,INABS,LNAB,XTHRMS,ITHRMS,LTHRM,
---
>       SUBROUTINE COLISN2(D,LD,IGAMS,LGAM,INABS,LNAB,XTHRMS,ITHRMS,LTHRM,
12742c12744
<       CALL GTMED(NMED,MED)
---
>       CALL GTMED2(NMED,MED)
12809c12811
<       CALL TBSPLT(D(LS1),E,LEN,SIGT)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGT)
12812c12814
<       COMM=' COLISN: TOTAL CROSS SECTION LENGTH IS ZERO'
---
>       COMM=' COLISN2: TOTAL CROSS SECTION LENGTH IS ZERO'
12823c12825
<       CALL TBSPLT(D(LS1),E,LEN,SIGTNA)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGTNA)
12830c12832
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12835c12837
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12842c12844
<       CALL TBSPLT(D(LS1),E,LEN,SIGNES)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNES)
12851c12853
<          CALL THRMSC(D,LD,XTHRMS,ITHRMS,LTHRM,E,U,V,W,TEMP,FM,AWR,IIN,
---
>          CALL THRMSC2(D,LD,XTHRMS,ITHRMS,LTHRM,E,U,V,W,TEMP,FM,AWR,IIN,
12854c12856
<          CALL CMLABE(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
---
>          CALL CMLABE2(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
12861c12863
<          CALL STOPAR(IDNEU,NNEU)
---
>          CALL STOPAR2(IDNEU,NNEU)
12870c12872
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
12873c12875
<    90 R=FLTRNF(0)
---
>    90 R=FLTRNF2(0)
12879c12881
<       CALL CMLABE(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG)
---
>       CALL CMLABE2(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG)
12886c12888
<       CALL STOPAR(IDNEU,NNEU)
---
>       CALL STOPAR2(IDNEU,NNEU)
12896c12898
<       CALL TBSPLT(D(LS1),E,LEN,SIGNIS)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNIS)
12902c12904
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
12908c12910
<          CALL XSECNU(D,LEN,E,SGNISD,LS1,L1)
---
>          CALL XSECNU2(D,LEN,E,SGNISD,LS1,L1)
12923c12925
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
12926c12928
<   150 R=FLTRNF(0)
---
>   150 R=FLTRNF2(0)
12934,12935c12936,12937
<       CALL CMLABI(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
< C Re-sample if no energy determined in CMLABI
---
>       CALL CMLABI2(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
> C Re-sample if no energy determined in CMLABI2
12943c12945
<       CALL STOPAR(IDNEU,NNEU)
---
>       CALL STOPAR2(IDNEU,NNEU)
12947c12949
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
12959c12961
<       CALL TBSPLT(D(LS1),E,LEN,SGNISC)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SGNISC)
12970c12972
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
12973c12975
<   190 CALL GTISO(U1,V1,W1)
---
>   190 CALL GTISO2(U1,V1,W1)
12983c12985
<       CALL SECEGY(EX,D(LS1),E,LD(LS1))
---
>       CALL SECEGY2(EX,D(LS1),E,LD(LS1))
12991,12992c12993,12994
<       CALL CMLABI(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
< C Re-sample if no energy determined in CMLABI
---
>       CALL CMLABI2(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
> C Re-sample if no energy determined in CMLABI2
13000c13002
<       CALL STOPAR(IDNEU,NNEU)
---
>       CALL STOPAR2(IDNEU,NNEU)
13004c13006
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13009c13011
<       COMM= ' COLISN: INELASTIC SCATTERING CROSS SECTION WAS NOT CHOSEN'
---
>       COMM=' COLISN: INELASTIC SCATTERING CROSS SECTION WAS NOT CHOSEN'
13014c13016
<       COMM=' COLISN: NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-91'
---
>       COMM=' COLISN2: NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-91'
13025c13027
<       CALL TBSPLT(D(LS1),E,LEN,SIGN2N)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGN2N)
13041c13043
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
13043c13045
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(2),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(2),LEN)
13054c13056
<       CALL GETENE(E,D(LS1),LD(LS1),INEU)
---
>       CALL GETENE2(E,D(LS1),LD(LS1),INEU)
13058,13059c13060,13061
<       CALL N2NN3N(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL N2NN3N2(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13063c13065
<       COMM=' COLISN: NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-16'
---
>       COMM=' COLISN2: NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-16'
13074c13076
<       CALL TBSPLT(D(LS1),E,LEN,SIGN3N)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGN3N)
13090c13092
<          CALL CANGLE(D(LS1),LD(LS1),E,FM(KN),LEN)
---
>          CALL CANGLE2(D(LS1),LD(LS1),E,FM(KN),LEN)
13102c13104
<       CALL GETENE(E,D(LS1),LD(LS1),INEU)
---
>       CALL GETENE2(E,D(LS1),LD(LS1),INEU)
13106,13107c13108,13109
<       CALL N2NN3N(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL N2NN3N2(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13111c13113
<       COMM= ' COLISN; NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-17'
---
>       COMM= ' COLISN2; NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-17'
13122c13124
<       CALL TBSPLT(D(LS1),E,LEN,SIGNNA)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNNA)
13133c13135
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
13136c13138
<   370 CALL GTISO(U1,V1,W1)
---
>   370 CALL GTISO2(U1,V1,W1)
13146c13148
<       CALL SECEGY(EX,D(LS1),E,LD(LS1))
---
>       CALL SECEGY2(EX,D(LS1),E,LD(LS1))
13153,13154c13155,13156
<       CALL CMLABI(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
< C Re-sample if no energy determined in CMLABI
---
>       CALL CMLABI2(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
> C Re-sample if no energy determined in CMLABI2
13162c13164
<       CALL STOPAR(IDNEU,NNEU)
---
>       CALL STOPAR2(IDNEU,NNEU)
13171,13172c13173,13174
<       CALL NN2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL NN2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13176c13178
<       COMM=' COLISN; NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-22'
---
>       COMM=' COLISN2; NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-22'
13187c13189
<       CALL TBSPLT(D(LS1),E,LEN,SGN2NA)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SGN2NA)
13202,13203c13204,13205
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(2),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(2),LEN)
13214c13216
<       CALL GETENE(E,D(LS1),LD(LS1),INEU)
---
>       CALL GETENE2(E,D(LS1),LD(LS1),INEU)
13218c13220
<       CALL N2NN3N(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
---
>       CALL N2NN3N2(D,LD,AWRI,KZI,ID,FM,QI,IFLG)
13227,13228c13229,13230
<       CALL NN2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL NN2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13232c13234
<       COMM=' COLISN; NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-24'
---
>       COMM=' COLISN2; NO SECONDARY ENERGY DISTRIBUTION WAS FOUND MT-24'
13243c13245
<       CALL TBSPLT(D(LS1),E,LEN,SIGNNP)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNNP)
13254c13256
<       CALL CANGLE(D(LS1),LD(LS1),E,FM(1),LEN)
---
>       CALL CANGLE2(D(LS1),LD(LS1),E,FM(1),LEN)
13257c13259
<   470 CALL GTISO(U1,V1,W1)
---
>   470 CALL GTISO2(U1,V1,W1)
13267c13269
<       CALL SECEGY(EX,D(LS1),E,LD(LS1))
---
>       CALL SECEGY2(EX,D(LS1),E,LD(LS1))
13274,13275c13276,13277
<       CALL CMLABI(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
< C Re-sample if no energy determined in CMLABI
---
>       CALL CMLABI2(D,LD,AWRI,KZI,ID,FM(1),QI,IFLG,LIFLAG,LRI)
> C Re-sample if no energy determined in CMLABI2
13283c13285
<       CALL STOPAR(IDNEU,NNEU)
---
>       CALL STOPAR2(IDNEU,NNEU)
13292,13293c13294,13295
<       CALL NN2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL NN2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13297c13299
<       COMM=' COLISN; NO SECONDARY ENERGY DISTRIBUTION FOUND FOR MT-28'
---
>       COMM=' COLISN2; NO SECONDARY ENERGY DISTRIBUTION FOUND FOR MT-28'
13319,13320c13321,13322
<       CALL LR2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,QLRI,ID,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL LR2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,QLRI,ID,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13338c13340
<       CALL LR2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,QBE8,ID,MT)
---
>       CALL LR2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,QBE8,ID,MT)
13347,13348c13349,13350
<       CALL LR2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QBE8,QLRI,ID,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL LR2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QBE8,QLRI,ID,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13364,13365c13366,13367
<       CALL LR2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,QLRI,ID,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL LR2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,QLRI,ID,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13375c13377
<       COMM=' COLISN: A SCATTERING REACTION TYPE WAS NOT CHOSEN '
---
>       COMM=' COLISN2: A SCATTERING REACTION TYPE WAS NOT CHOSEN '
13385c13387
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
13394c13396
<       CALL TBSPLT(D(LS1),E,LEN,SIGNF)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNF)
13401c13403
<       CALL GETNU(D(LS1),LD(LS1),EOLD,LEN,XNU)
---
>       CALL GETNU2(D(LS1),LD(LS1),EOLD,LEN,XNU)
13414c13416
<   580 CALL GPOISS(XNU,INEU,1)
---
>   580 CALL G3POISS(XNU,INEU,1)
13424c13426
<          CALL CANGLE(D(LS1),LD(LS1),E,FM(KN),LEN)
---
>          CALL CANGLE2(D(LS1),LD(LS1),E,FM(KN),LEN)
13435c13437
<       IF(INEU.GT.0) CALL GETENE(E,D(LS1),LD(LS1),INEU)
---
>       IF(INEU.GT.0) CALL GETENE2(E,D(LS1),LD(LS1),INEU)
13443,13444c13445,13446
<       IF(INEU.GT.0) CALL LABNF(D,LD,FM,AWRI,KZI,QI,LIFLAG)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       IF(INEU.GT.0) CALL LABNF2(D,LD,FM,AWRI,KZI,QI,LIFLAG)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13447c13449
<       CALL BANKR(D,LD,3)
---
>       CALL BANKR2(D,LD,3)
13450c13452
<       COMM=' COLISN: NO SECONDARY ENERGY DISTRIBUTION FOUND FOR MT-18'
---
>       COMM=' COLISN2: NO SECONDARY ENERGY DISTRIBUTION FOUND FOR MT-18'
13456c13458
<       COMM=' COLISN: NO NUMBER OF FISSION NEUTRON FOUND FOR MT-18'
---
>       COMM=' COLISN2: NO NUMBER OF FISSION NEUTRON FOUND FOR MT-18'
13469c13471
<       CALL TBSPLT(D(LS1),E,LEN,SIGNG)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNG)
13475c13477
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13478c13480
<       CALL NGHEVY(D,LD,KZI,AWRI,QI,MT)
---
>       CALL NGHEVY2(D,LD,KZI,AWRI,QI,MT)
13489c13491
<       CALL TBSPLT(D(LS1),E,LEN,SIGNP)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNP)
13504,13505c13506,13507
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13509c13511
<   680 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   680 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13520c13522
<       CALL TBSPLT(D(LS1),E,LEN,SIGND)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGND)
13537,13538c13539,13540
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13542c13544
<   710 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   710 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13553c13555
<       CALL TBSPLT(D(LS1),E,LEN,SIGNT)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNT)
13569,13570c13571,13572
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13574c13576
<   740 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   740 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13585c13587
<       CALL TBSPLT(D(LS1),E,LEN,SGN3HE)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SGN3HE)
13600,13601c13602,13603
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13605c13607
<   770 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   770 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13616c13618
<       CALL TBSPLT(D(LS1),E,LEN,SIGNA)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNA)
13631,13632c13633,13634
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13636c13638
<   800 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   800 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13647c13649
<       CALL TBSPLT(D(LS1),E,LEN,SIGN2A)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGN2A)
13664,13665c13666,13667
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13669c13671
<   830 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   830 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13680c13682
<       CALL TBSPLT(D(LS1),E,LEN,SIGN3A)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGN3A)
13696,13697c13698,13699
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13709c13711
<       CALL TBSPLT(D(LS1),E,LEN,SIGN2P)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGN2P)
13726,13727c13728,13729
<       CALL TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13731c13733
<   880 CALL GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
---
>   880 CALL GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,QI,MT)
13742c13744
<       CALL TBSPLT(D(LS1),E,LEN,SIGNPA)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SIGNPA)
13760,13761c13762,13763
<       CALL TREBOD(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TREBOD2(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13773c13775
<       CALL TBSPLT(D(LS1),E,LEN,SGNT2A)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SGNT2A)
13791,13792c13793,13794
<       CALL TREBOD(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TREBOD2(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13804c13806
<       CALL TBSPLT(D(LS1),E,LEN,SGND2A)
---
>       CALL TBSPLT2(D(LS1),E,LEN,SGND2A)
13822,13823c13824,13825
<       CALL TREBOD(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,ATAR,QI,MT)
<       CALL PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
---
>       CALL TREBOD2(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,ATAR,QI,MT)
>       CALL PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,AWR,
13836c13838
<       COMM=' COLISN:AN ABSORPTION REACTION TYPE WAS NOT CHOSEN '
---
>       COMM=' COLISN2:AN ABSORPTION REACTION TYPE WAS NOT CHOSEN '
13853,13854c13855,13856
<       SUBROUTINE CTERP(X1,X2,X,Y1,Y2,Y)
< C       THIS ROUTINE PERFORMS LINEAR INTERPOLATION
---
>       SUBROUTINE CTERP2(X1,X2,X,Y1,Y2,Y)
> C       THIS ROUTINE PERFORMS LINEAR INTERP2OLATION
13860c13862
<       SUBROUTINE EVAPLR(E,Q,SQ,ATAR,CB,EX)
---
>       SUBROUTINE EVAPLR2(E,Q,SQ,ATAR,CB,EX)
13888c13890
<      1'EVAPLR --- INDICATING PROBABLE CROSS SECTION ERROR ALLOWING ',
---
>      1'EVAPLR2 --- INDICATING PROBABLE CROSS SECTION ERROR ALLOWING ',
13890c13892
<       WRITE(6,*) ' CALOR: ERROR in EVAPLR ====> STOP '
---
>       WRITE(6,*) ' CALOR: ERROR in EVAPLR2 ====> STOP '
13892c13894
< C       CALCULATE THE NUCLEAR TEMPERATURE (THETA)
---
> C       CALCULATE THE NUCLEAR2 TEMPERATURE (THETA)
13895,13896c13897,13898
<    20 R1=FLTRNF(0)
<       R2=FLTRNF(0)
---
>    20 R1=FLTRNF2(0)
>       R2=FLTRNF2(0)
13901c13903
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
13909c13911
<       FUNCTION FISRNF(A,B)
---
>       FUNCTION FISRNF2(A,B)
13924c13926
<       FISRNF = E1
---
>       FISRNF2 = E1
13930c13932
<       FUNCTION FLTRNF(IX)
---
>       FUNCTION FLTRNF2(IX)
13933c13935
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
13935c13937
<       FLTRNF = RANDC(ISEED)
---
>       FLTRNF2 = RANDC2(ISEED)
13940c13942
<       SUBROUTINE GETENE(EN,D1,LD2,N)
---
>       SUBROUTINE GETENE2(EN,D1,LD2,N)
13957c13959
<          CALL SECEGY(EX,D1,EN,LD2)
---
>          CALL SECEGY2(EX,D1,EN,LD2)
13965c13967
<       SUBROUTINE GETNU(D,LD,E,LEN,XNU)
---
>       SUBROUTINE GETNU2(D,LD,E,LEN,XNU)
13997,13998c13999,14000
< C       INTERPOLATION RANGE (NR) AND ONLY LINEAR-LINEAR
< C       INTERPOLABLE DATA (INT=2)
---
> C       INTERP2OLATION RANGE (NR) AND ONLY LINEAR-LINEAR
> C       INTERP2OLABLE DATA (INT=2)
14004,14005c14006,14007
< C       LINEAR-LINEAR INTERPOLATION IS ASSUMED AT THIS POINT
<       CALL TBSPLT(D(IP),E,NP,XNU)
---
> C       LINEAR-LINEAR INTERP2OLATION IS ASSUMED AT THIS POINT
>       CALL TBSPLT2(D(IP),E,NP,XNU)
14008,14009c14010,14011
< 10000 FORMAT(' MICAP: ERROR IN ROUTINE GETNU; LNU=',I3)
<       WRITE(6,*) ' CALOR: ERROR in GETNU ====> STOP'
---
> 10000 FORMAT(' MICAP: ERROR IN ROUTINE GETNU2; LNU=',I3)
>       WRITE(6,*) ' CALOR: ERROR in GETNU2 ====> STOP'
14014c14016
<       SUBROUTINE GETPAR(ID,N,IERR)
---
>       SUBROUTINE GATPAR2(ID,N,IERR)
14064c14066
<       SUBROUTINE GRNDST(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,MT)
---
>       SUBROUTINE GRNDST2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,MT)
14119c14121
<          R=FLTRNF(0)
---
>          R=FLTRNF2(0)
14146c14148
<          CALL AZIRN(SINETA,COSETA)
---
>          CALL AZIRN2(SINETA,COSETA)
14200c14202
<          CALL STOPAR(IDHEVY,NHEVY)
---
>          CALL STOPAR2(IDHEVY,NHEVY)
14251c14253
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
14256c14258
<       SUBROUTINE GTMED(MEDGEA,MEDMOR)
---
>       SUBROUTINE GTMED2(MEDGEA,MEDMOR)
14296c14298
<       WRITE(IOUT,'('' MICAP GTMED: GEANT Medium '',I5, '
---
>       WRITE(IOUT,'('' MICAP GTMED2: GEANT Medium '',I5, '
14303,14305c14305,14307
<       SUBROUTINE INTERP(X,Y,X1,Y1,X2,Y2,INT)
< C       THIS ROUTINE PERFORMS THE INTERPOLATION ACCORDING
< C       TO THE ENDF/B INTERPOLATION SCHEME INT
---
>       SUBROUTINE INTERP2(X,Y,X1,Y1,X2,Y2,INT)
> C       THIS ROUTINE PERFORMS THE INTERP2OLATION ACCORDING
> C       TO THE ENDF/B INTERP2OLATION SCHEME INT
14333,14334c14335,14336
< 10000 FORMAT(' MICAP: INTERP-INVALID INTERPOLATION SCHEME',I11)
<       WRITE(6,*) ' CALOR: ERROR in INTERP ====> STOP '
---
> 10000 FORMAT(' MICAP: INTERP2-INVALID INTERP2OLATION SCHEME',I11)
>       WRITE(6,*) ' CALOR: ERROR in INTERP2 ====> STOP '
14339,14340c14341,14342
<       SUBROUTINE INTSCH(IFSE,I,IS,NR)
< C       THIS ROUTINE DETERMINES THE INTERPOLATION SCHEME
---
>       SUBROUTINE INTSCH2(IFSE,I,IS,NR)
> C       THIS ROUTINE DETERMINES THE INTERP2OLATION SCHEME
14353c14355
<       SUBROUTINE ISOTPE(D,LD,KM,RHO,IN,IDICTS,LDICT,E,TSIG,NMED,
---
>       SUBROUTINE ISOTPE2(D,LD,KM,RHO,IN,IDICTS,LDICT,E,TSIG,NMED,
14381c14383
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
14393c14395
<          CALL TBSPLT(D(LS1),E,LEN,X)
---
>          CALL TBSPLT2(D(LS1),E,LEN,X)
14402c14404
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
14409c14411
<      +'ROUTINE ISOTPE',/,3X,'MEDIUM=',I5,5X,'MACROSCOPIC XSEC=',
---
>      +'ROUTINE ISOTPE2',/,3X,'MEDIUM=',I5,5X,'MACROSCOPIC XSEC=',
14413c14415
<       WRITE(6,*) ' CALOR: ERROR in ISOTPE =====> STOP '
---
>       WRITE(6,*) ' CALOR: ERROR in ISOTPE2 =====> STOP '
14418c14420
<       SUBROUTINE LABNF(D,LD,FM,AWR,KZ,Q,LIFLAG)
---
>       SUBROUTINE LABNF2(D,LD,FM,AWR,KZ,Q,LIFLAG)
14470c14472
<             CALL GTISO(UP,VP,WP)
---
>             CALL GTISO2(UP,VP,WP)
14473c14475
<             CALL AZIRN(SINETA,COSETA)
---
>             CALL AZIRN2(SINETA,COSETA)
14504c14506
<          CALL STOPAR(IDNEU,NNEU)
---
>          CALL STOPAR2(IDNEU,NNEU)
14548c14550
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
14553c14555
<       SUBROUTINE LR2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,SQ,ID,MT)
---
>       SUBROUTINE LR2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,SQ,ID,MT)
14614c14616
<       CALL BARIER(KZ1,KZ2,A1,A2,CB)
---
>       CALL BARIER2(KZ1,KZ2,A1,A2,CB)
14616c14618
<       CALL EVAPLR(E,Q,SQ,ATAR,CB,EX)
---
>       CALL EVAPLR2(E,Q,SQ,ATAR,CB,EX)
14631c14633
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
14646c14648
<       CALL AZIRN(SINETA,COSETA)
---
>       CALL AZIRN2(SINETA,COSETA)
14696c14698
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
14750c14752
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
14755c14757
<       SUBROUTINE LRNORM(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,XSLR)
---
>       SUBROUTINE LRNORM2(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,XSLR)
14757c14759
< C       USED TO CALCULATE THE PHOTON MULTIPLICITY WHEN THE
---
> C       USED TO CALCULATE THE PHOTON2 MULTIPLICITY WHEN THE
14796c14798
<          CALL XSECNU(D,LEN,EOLD,SIG,LS1,L1)
---
>          CALL XSECNU2(D,LEN,EOLD,SIG,LS1,L1)
14809c14811
<       SUBROUTINE MATISO(IZ,IA,NI,IDISO,FSINGL,NUNIT)
---
>       SUBROUTINE MATISO2(IZ,IA,NI,IDISO,FSINGL,NUNIT)
14884c14886
<          WRITE(IOUT,'('' MATISO: Error in neutron x-section '',   '
---
>          WRITE(IOUT,'('' MATISO2: Error in neutron x-section '',   '
15080c15082
<       CALL GTMED(NMED,IMED)
---
>       CALL GTMED2(NMED,IMED)
15082c15084
<       CALL NSIGTA(E,NMED,TSIG,D,LD(LFP32),LD(LFP33))
---
>       CALL NSIGTA2(E,NMED,TSIG,D,LD(LFP32),LD(LFP33))
15084,15085c15086,15087
<       CALL ISOTPE(D,LD,LD(LFP10),D(LFP12),LD(LFP16),LD(LFP26),LD(LFP27),
<      +            E,TSIG,IMED,IIN,IIM)
---
>       CALL ISOTPE2(D,LD,LD(LFP10),D(LFP12),LD(LFP16),LD(LFP26),LD(LFP27)
>      +             ,E,TSIG,IMED,IIN,IIM) 
15097c15099
<       CALL COLISN(D,LD,LD(LFP20),LD(LFP21),LD(LFP22),LD(LFP23),
---
>       CALL COLISN2(D,LD,LD(LFP20),LD(LFP21),LD(LFP22),LD(LFP23),
15110c15112
<       CALL BANKR(D,LD,5)
---
>       CALL BANKR2(D,LD,5)
15121c15123
<          CALL GETPAR(IDNEU,N,IERR)
---
>          CALL GATPAR2(IDNEU,N,IERR)
15136c15138
<          CALL GETPAR(IDHEVY,N,IERR)
---
>          CALL GATPAR2(IDHEVY,N,IERR)
15168c15170
<          CALL GETPAR(IDGAMA,N,IERR)
---
>          CALL GATPAR2(IDGAMA,N,IERR)
15323c15325,15326
<             CALL GETENV('CERN_ROOT',CHROOT)
---
> C modif for VMC 	    
>             CALL GETENVF('G3SYS',CHROOT)
15325c15328
<             IF(LNROOT.GT.0)XSFILE = CHROOT(1:LNROOT)//'/lib/xsneut.dat'
---
>             IF(LNROOT.GT.0)XSFILE = CHROOT(1:LNROOT)//'/data/xsneut.dat'
15361c15364
<         CALL CHKZEB(NWW,IXCONS)
---
>         CALL CHKZEB2(NWW,IXCONS)
15392c15395
<         CALL CHKZEB(NWW,IXCONS)
---
>         CALL CHKZEB2(NWW,IXCONS)
15566c15569
<                CALL MATISO(IZ,IA,NNI,IDI,FSINGL,NUNIT)
---
>                CALL MATISO2(IZ,IA,NNI,IDI,FSINGL,NUNIT)
15572c15575
<             CALL MATISO(IZ,IA,NNI,IDI,FSINGL,NUNIT)
---
>             CALL MATISO2(IZ,IA,NNI,IDI,FSINGL,NUNIT)
15580c15583
<       CALL CHKZEB(NW,IXCONS)
---
>       CALL CHKZEB2(NW,IXCONS)
15632c15635
<                   CALL MATISO(IZ,IA,NNI,IDI,FSINGL,NUNIT)
---
>                   CALL MATISO2(IZ,IA,NNI,IDI,FSINGL,NUNIT)
15639c15642
<                      CALL MATISO(IZ,IA,NNI,IDI,FSINGL,NUNIT)
---
>                      CALL MATISO2(IZ,IA,NNI,IDI,FSINGL,NUNIT)
15659c15662
<                CALL MATISO(IZ,IA,NNI,IDI,FSINGL,NUNIT)
---
>                CALL MATISO2(IZ,IA,NNI,IDI,FSINGL,NUNIT)
15688c15691
<             CALL MATISO(IZ,IA,NNI,IDI,FSINGL,NUNIT)
---
>             CALL MATISO2(IZ,IA,NNI,IDI,FSINGL,NUNIT)
15731c15734
<       CALL MOXSEC
---
>       CALL MOXSEC2
15745c15748
<       SUBROUTINE MOXSEC
---
>       SUBROUTINE MOXSEC2
15848c15851
<       CALL CHKZEB(NW,IXCONS)
---
>       CALL CHKZEB2(NW,IXCONS)
15858c15861
<       CALL XSECN1(NII,LD(LFP11),LD(LFP16),LD(LFP17),
---
>       CALL XSECN12(NII,LD(LFP11),LD(LFP16),LD(LFP17),
15875c15878
< C store xs accuracy at LFP210 (used for thinning  in XSECN3)
---
> C store xs accuracy at LFP210 (used for thinning  in XSECN32)
15892,15893c15895,15896
< C       CLEAR THE STORAGE LOCATIONS FOR THE DICTIONARIES, ETC.
<       CALL CLEAR(LD,LFP20,LFP36-1)
---
> C       CLEAR2 THE STORAGE LOCATIONS FOR THE DICTIONARIES, ETC.
>       CALL CLEAR2(LD,LFP20,LFP36-1)
15905c15908
<       CALL CHKZEB(NW,IXCONS)
---
>       CALL CHKZEB2(NW,IXCONS)
15911c15914
<       CALL XSECN2(LD(LFP17),LD(LFP18),LD(LFP18A),
---
>       CALL XSECN22(LD(LFP17),LD(LFP18),LD(LFP18A),
15938c15941
<       CALL CHKZEB(NW,IXCONS)
---
>       CALL CHKZEB2(NW,IXCONS)
15945c15948
<       CALL XSECN3(LD(LFP10),LD(LFP11),D(LFP12),LD(LFP16),LD(LFP26),
---
>       CALL XSECN32(LD(LFP10),LD(LFP11),D(LFP12),LD(LFP16),LD(LFP26),
15948c15951
< C       ESTABLISH THE PHOTON TOTAL CROSS SECTION DATA DICTIONARY
---
> C       ESTABLISH THE PHOTON2 TOTAL CROSS SECTION DATA DICTIONARY
15950c15953
< C determine number of words needed for photon production xs
---
> C determine number of words needed for photon2 production xs
15961c15964
<       CALL CHKZEB(NW,IXCONS)
---
>       CALL CHKZEB2(NW,IXCONS)
15970,15973c15973,15976
< C       CLEAR THE STORAGE LOCATIONS FOR THE PHOTON DICTIONARIES
< C       OF THE TOTAL PHOTON PRODUCTION CROSS SECTIONS
<       CALL CLEAR(LD,LFP45,LFP47-1)
< C       SUM THE PHOTON PARTIAL DISTRIBUTIONS OF THE ENDF/B-V
---
> C       CLEAR2 THE STORAGE LOCATIONS FOR THE PHOTON2 DICTIONARIES
> C       OF THE TOTAL PHOTON2 PRODUCTION CROSS SECTIONS
>       CALL CLEAR2(LD,LFP45,LFP47-1)
> C       SUM THE PHOTON2 PARTIAL DISTRIBUTIONS OF THE ENDF/B-V
15976c15979
<       CALL XSECN5(LD(LFP28),LD(LFP30),LD(LFP31),LD(LFP45),LD(LFP46),
---
>       CALL XSECN52(LD(LFP28),LD(LFP30),LD(LFP31),LD(LFP45),LD(LFP46),
16008c16011
<          CALL TBSPLT(D(LS1),EN,LEN,XSEC)
---
>          CALL TBSPLT2(D(LS1),EN,LEN,XSEC)
16017c16020
<           CALL GFMATE(LD(LGE2MO+LD(LFP10+I)),MATNAM,AA,ZZ,DENS,
---
>           CALL G3FMATE(LD(LGE2MO+LD(LFP10+I)),MATNAM,AA,ZZ,DENS,
16132c16135
<       SUBROUTINE N2NN3N(D,LD,AWR,KZ,ID,FM,Q,IFLG)
---
>       SUBROUTINE N2NN3N2(D,LD,AWR,KZ,ID,FM,Q,IFLG)
16185c16188
<             CALL GTISO(UP,VP,WP)
---
>             CALL GTISO2(UP,VP,WP)
16188c16191
<             CALL AZIRN(SINETA,COSETA)
---
>             CALL AZIRN2(SINETA,COSETA)
16219c16222
<          CALL STOPAR(IDNEU,NNEU)
---
>          CALL STOPAR2(IDNEU,NNEU)
16272c16275
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
16277c16280
<       SUBROUTINE NGHEVY(D,LD,KZ,AWR,Q,MT)
---
>       SUBROUTINE NGHEVY2(D,LD,KZ,AWR,Q,MT)
16283c16286
< C       WITH THE PHOTONS MOMENTUM EQUAL TO ITS ENERGY.
---
> C       WITH THE PHOTON2S MOMENTUM EQUAL TO ITS ENERGY.
16327c16330
< C       CALCULATE THE TOTAL MOMEMTUM OF THE EXIT PHOTON
---
> C       CALCULATE THE TOTAL MOMEMTUM OF THE EXIT PHOTON2
16369c16372
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
16374c16377
<       SUBROUTINE NN2BOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,MT)
---
>       SUBROUTINE NN2BOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,MT)
16429c16432
<       CALL BARIER(KZ1,KZ2,A1,A2,CB)
---
>       CALL BARIER2(KZ1,KZ2,A1,A2,CB)
16431c16434
<       CALL CEVAP1(EOLD,E,Q,ATAR,CB,EX)
---
>       CALL CEVAP21(EOLD,E,Q,ATAR,CB,EX)
16434c16437
<       CALL GTISO(U1,V1,W1)
---
>       CALL GTISO2(U1,V1,W1)
16468c16471
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
16521c16524
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
16526c16529
<       SUBROUTINE NSIGTA(E,JMED,TSIG,D,ISIGTS,LSIGT)
---
>       SUBROUTINE NSIGTA2(E,JMED,TSIG,D,ISIGTS,LSIGT)
16538c16541
<       CALL GTMED(JMED,MED)
---
>       CALL GTMED2(JMED,MED)
16543c16546
<       CALL TBSPLT(D(LS1),E,LEN,TSIG)
---
>       CALL TBSPLT2(D(LS1),E,LEN,TSIG)
16548,16549c16551,16552
<       SUBROUTINE PARTXS(D,LD,E,SIGTOT,EP)
< C       THIS ROUTINE SAMPLES FROM THE FILE 12 OR 13 PHOTON
---
>       SUBROUTINE PARTXS2(D,LD,E,SIGTOT,EP)
> C       THIS ROUTINE SAMPLES FROM THE FILE 12 OR 13 PHOTON2
16551c16554
< C       PHOTON ENERGY FROM A NEUTRON REACTION
---
> C       PHOTON2 ENERGY FROM A NEUTRON REACTION
16565c16568
<    10 R=FLTRNF(0)
---
>    10 R=FLTRNF2(0)
16602c16605
< C       LINEAR INTERPOLATION
---
> C       LINEAR INTERP2OLATION
16650c16653
<       SUBROUTINE PHOTON(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,
---
>       SUBROUTINE PHOTON2(D,LD,IDICTS,LDICT,NTX,NTS,IGCBS,LGCB,
16653,16654c16656,16657
< C       PHOTONS PRODUCED BY THE NEUTRON INTERACTIONS.  WHERE DATA
< C       PERMITS, THE PHOTON PRODUCED IS DIRECTLY COUPLED TO THE
---
> C       PHOTON2S PRODUCED BY THE NEUTRON INTERACTIONS.  WHERE DATA
> C       PERMITS, THE PHOTON2 PRODUCED IS DIRECTLY COUPLED TO THE
16701c16704
< C flag to mark call to SECEGY = 1 or PARTXS = 2 for EP   CZ 13/8/92
---
> C flag to mark call to SECEGY2 = 1 or PARTXS2 = 2 for EP   CZ 13/8/92
16703c16706
< C       INITIALIZE THE PHOTON ENERGY TO ZERO IN CASE NO PHOTON IS
---
> C       INITIALIZE THE PHOTON2 ENERGY TO ZERO IN CASE NO PHOTON2 IS
16718c16721
< C       NO PHOTON DATA PRESENT (IF L=0)
---
> C       NO PHOTON2 DATA PRESENT (IF L=0)
16750c16753
< C       CHECK PHOTON PRODUCTION DICTIONARY TO SEE IF THERE IS PHOTON
---
> C       CHECK PHOTON2 PRODUCTION DICTIONARY TO SEE IF THERE IS PHOTON2
16760c16763
< C       PHOTON DATA FOUND CORRESPONDING TO NEUTRON MT REACTION
---
> C       PHOTON2 DATA FOUND CORRESPONDING TO NEUTRON MT REACTION
16765c16768
<       CALL TBSPLT(D(LS1),EOLD,LEN,SIGP)
---
>       CALL TBSPLT2(D(LS1),EOLD,LEN,SIGP)
16768,16769c16771,16772
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL PARTXS(D(LS2),LD(LS2),EOLD,SIGP,EP)
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL PARTXS2(D(LS2),LD(LS2),EOLD,SIGP,EP)
16772,16773c16775,16776
< C       DISCRETE PHOTON ENERGY WAS NOT SELECTED (EP=0.0)
< C       CHECK SECONDARY PHOTON DISTRIBUTION (FILE 15) FOR EP
---
> C       DISCRETE PHOTON2 ENERGY WAS NOT SELECTED (EP=0.0)
> C       CHECK SECONDARY PHOTON2 DISTRIBUTION (FILE 15) FOR EP
16778c16781
< C no file 15 found and EP=0 in PARTXS -> try MT=4 etc
---
> C no file 15 found and EP=0 in PARTXS2 -> try MT=4 etc
16783,16784c16786,16787
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL SECEGY(EP,D(LS3),EOLD,LD(LS3))
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL SECEGY2(EP,D(LS3),EOLD,LD(LS3))
16786c16789
< C       DETERMINE THE PHOTON MULTIPLICITY (YP)
---
> C       DETERMINE THE PHOTON2 MULTIPLICITY (YP)
16788,16791c16791,16794
< C       PHOTON MULTIPLICITY TO ACCOUNT FOR THE LR-FLAGS
<    60 IF(LRI.EQ.22)CALL LRNORM(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGN)
<       IF(LRI.EQ.23)CALL LRNORM(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGN)
<       IF(LRI.EQ.28)CALL LRNORM(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGN)
---
> C       PHOTON2 MULTIPLICITY TO ACCOUNT FOR THE LR-FLAGS
>    60 IF(LRI.EQ.22)CALL LRNORM2(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGN)
>       IF(LRI.EQ.23)CALL LRNORM2(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGN)
>       IF(LRI.EQ.28)CALL LRNORM2(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGN)
16794,16796c16797,16799
< C       THE DISCRETE INELASTIC LEVEL PHOTON DATA WAS NOT FOUND
< C       CHECK THE PHOTON PRODUCTION DICTIONARY TO SEE IF THERE IS
< C       PHOTON DATA CORRESPONDING TO MT=4
---
> C       THE DISCRETE INELASTIC LEVEL PHOTON2 DATA WAS NOT FOUND
> C       CHECK THE PHOTON2 PRODUCTION DICTIONARY TO SEE IF THERE IS
> C       PHOTON2 DATA CORRESPONDING TO MT=4
16802c16805
< C       PHOTON DATA FOUND CORRESPONDING TO MT=4
---
> C       PHOTON2 DATA FOUND CORRESPONDING TO MT=4
16807c16810
<       CALL TBSPLT(D(LS1),EOLD,LEN,SIGP)
---
>       CALL TBSPLT2(D(LS1),EOLD,LEN,SIGP)
16810,16811c16813,16814
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL PARTXS(D(LS2),LD(LS2),EOLD,SIGP,EP)
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL PARTXS2(D(LS2),LD(LS2),EOLD,SIGP,EP)
16814,16815c16817,16818
< C       DISCRETE PHOTON ENERGY WAS NOT SELECTED (EP=0.0)
< C       CHECK SECONDARY PHOTON DISTRIBUTION (FILE 15) FOR EP
---
> C       DISCRETE PHOTON2 ENERGY WAS NOT SELECTED (EP=0.0)
> C       CHECK SECONDARY PHOTON2 DISTRIBUTION (FILE 15) FOR EP
16824,16825c16827,16828
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL SECEGY(EP,D(LS3),EOLD,LD(LS3))
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL SECEGY2(EP,D(LS3),EOLD,LD(LS3))
16827c16830
< C       DETERMINE THE PHOTON MULTIPLICITY (YP)
---
> C       DETERMINE THE PHOTON2 MULTIPLICITY (YP)
16829c16832
< C       PHOTON MULTIPLICITY TO ACCOUNT FOR THE LR-FLAGS
---
> C       PHOTON2 MULTIPLICITY TO ACCOUNT FOR THE LR-FLAGS
16831c16834
<       CALL LRNORM(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGNIS)
---
>       CALL LRNORM2(D,LD,IDICTS,LDICT,LR,EOLD,MT,IIN,SIGNIS)
16834c16837
< C       CHECK PHOTON PRODUCTION DICTIONARY TO SEE IF THERE IS PHOTON
---
> C       CHECK PHOTON2 PRODUCTION DICTIONARY TO SEE IF THERE IS PHOTON2
16841c16844
< C       PHOTON DATA FOUND CORRESPONDING TO NEUTRON MT REACTION
---
> C       PHOTON2 DATA FOUND CORRESPONDING TO NEUTRON MT REACTION
16846c16849
<       CALL TBSPLT(D(LS1),EOLD,LEN,SIGP)
---
>       CALL TBSPLT2(D(LS1),EOLD,LEN,SIGP)
16849,16850c16852,16853
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL PARTXS(D(LS2),LD(LS2),EOLD,SIGP,EP)
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL PARTXS2(D(LS2),LD(LS2),EOLD,SIGP,EP)
16853,16854c16856,16857
< C       DISCRETE PHOTON ENERGY WAS NOT SELECTED (EP=0.0)
< C       CHECK SECONDARY PHOTON DISTRIBUTION (FILE 15) FOR EP
---
> C       DISCRETE PHOTON2 ENERGY WAS NOT SELECTED (EP=0.0)
> C       CHECK SECONDARY PHOTON2 DISTRIBUTION (FILE 15) FOR EP
16863,16864c16866,16867
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL SECEGY(EP,D(LS3),EOLD,LD(LS3))
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL SECEGY2(EP,D(LS3),EOLD,LD(LS3))
16866c16869
< C       DETERMINE THE PHOTON MULTIPLICITY (YP)
---
> C       DETERMINE THE PHOTON2 MULTIPLICITY (YP)
16869,16871c16872,16874
< C       NO PHOTON DATA WAS FOUND FOR THE PARTICULAR NEUTRON MT
< C       REACTION OR FOR NEUTRON MT=4, THEREFORE CHECK THE PHOTON
< C       PRODUCTION DICTIONARY TO SEE IF THERE IS PHOTON DATA
---
> C       NO PHOTON2 DATA WAS FOUND FOR THE PARTICULAR NEUTRON MT
> C       REACTION OR FOR NEUTRON MT=4, THEREFORE CHECK THE PHOTON2
> C       PRODUCTION DICTIONARY TO SEE IF THERE IS PHOTON2 DATA
16878c16881
< C       PHOTON DATA FOUND CORRESPONDING TO MT=3
---
> C       PHOTON2 DATA FOUND CORRESPONDING TO MT=3
16883c16886
<       CALL TBSPLT(D(LS1),EOLD,LEN,SIGP)
---
>       CALL TBSPLT2(D(LS1),EOLD,LEN,SIGP)
16886,16887c16889,16890
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL PARTXS(D(LS2),LD(LS2),EOLD,SIGP,EP)
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL PARTXS2(D(LS2),LD(LS2),EOLD,SIGP,EP)
16890,16891c16893,16894
< C       DISCRETE PHOTON ENERGY WAS NOT SELECTED (EP=0.0)
< C       CHECK SECONDARY PHOTON DISTRIBUTION (FILE 15) FOR EP
---
> C       DISCRETE PHOTON2 ENERGY WAS NOT SELECTED (EP=0.0)
> C       CHECK SECONDARY PHOTON2 DISTRIBUTION (FILE 15) FOR EP
16900,16901c16903,16904
< C       DETERMINE EXIT PHOTON ENERGY (EP)
<       CALL SECEGY(EP,D(LS3),EOLD,LD(LS3))
---
> C       DETERMINE EXIT PHOTON2 ENERGY (EP)
>       CALL SECEGY2(EP,D(LS3),EOLD,LD(LS3))
16903c16906
< C       THE PHOTON WAS SELECTED FROM PHOTON DATA FOR MT=3
---
> C       THE PHOTON2 WAS SELECTED FROM PHOTON2 DATA FOR MT=3
16906c16909
< C       DATA AS MT=3 DOES IN THE PHOTON DATA
---
> C       DATA AS MT=3 DOES IN THE PHOTON2 DATA
16913c16916
<       CALL TBSPLT(D(LS1),EOLD,LEN,XSIG2)
---
>       CALL TBSPLT2(D(LS1),EOLD,LEN,XSIG2)
16920c16923
< C       SCAN THE PHOTON PRODUCTION DICTIONARY FOR ALL MT NUMBERS
---
> C       SCAN THE PHOTON2 PRODUCTION DICTIONARY FOR ALL MT NUMBERS
16929,16930c16932,16933
<          CALL TBSPLT(D(LS1),EOLD,LEN,SIGEX)
< C     IF THE TOTAL PHOTON PRODUCTION CROSS SECTION IS ZERO AT
---
>          CALL TBSPLT2(D(LS1),EOLD,LEN,SIGEX)
> C     IF THE TOTAL PHOTON2 PRODUCTION CROSS SECTION IS ZERO AT
16964c16967
<          CALL TBSPLT(D(LS1),EOLD,LEN,XSIG)
---
>          CALL TBSPLT2(D(LS1),EOLD,LEN,XSIG)
16970c16973
< C    DETERMINE THE PHOTON MULTIPLICITY (YP)
---
> C    DETERMINE THE PHOTON2 MULTIPLICITY (YP)
16976c16979
< C       ENDF/B DATA INCONSISTENCY WHICH COULD YIELD A PHOTON OF
---
> C       ENDF/B DATA INCONSISTENCY WHICH COULD YIELD A PHOTON2 OF
16978,16979c16981,16982
< C       PHOTON WEIGHT FROM THE GENERAL PHOTON YIELD ARRAY AND
< C       ADJUST THE WEIGHT TO PHOTONS PER NON-ELASTIC COLLISION.
---
> C       PHOTON2 WEIGHT FROM THE GENERAL PHOTON2 YIELD ARRAY AND
> C       ADJUST THE WEIGHT TO PHOTON2S PER NON-ELASTIC COLLISION.
16984c16987
<       CALL TBSPLT(D(LS1),EOLD,LEN,YP)
---
>       CALL TBSPLT2(D(LS1),EOLD,LEN,YP)
16989c16992
< C       THE WEIGHT ENDF/B-V DATA MAY GIVE A PARTICULAR PHOTON.
---
> C       THE WEIGHT ENDF/B-V DATA MAY GIVE A PARTICULAR PHOTON2.
16991c16994
< C       75 TO A PARTICULAR PHOTON.  BECAUSE SUCH A PHOTON COULD
---
> C       75 TO A PARTICULAR PHOTON2.  BECAUSE SUCH A PHOTON2 COULD
16993,16994c16996,16997
< C       MULTIPLICITY (PHOTON WEIGHT) IS DISTRIBUTED TO SEVERAL
< C       PHOTONS (SPLITTING OF SORTS) WITH BOTH WEIGHT AND ENERGY
---
> C       MULTIPLICITY (PHOTON2 WEIGHT) IS DISTRIBUTED TO SEVERAL
> C       PHOTON2S (SPLITTING OF SORTS) WITH BOTH WEIGHT AND ENERGY
16999c17002
< C for a photon multiplicity > 1.01 a poisson distribution is sampled
---
> C for a photon2 multiplicity > 1.01 a poisson distribution is sampled
17006c17009
<   340   CALL GPOISS(YP,NUMBG,1)
---
>   340   CALL G3POISS(YP,NUMBG,1)
17012,17013c17015,17016
< C number of photons generated = INT(YP)
< C plus an additional photon if YP-INT(YP) > random number
---
> C number of photon2s generated = INT(YP)
> C plus an additional photon2 if YP-INT(YP) > random number
17016c17019
<         IF((YP-FLOAT(NUMBG)).GT.FLTRNF(0)) NUMBG = NUMBG + 1
---
>         IF((YP-FLOAT(NUMBG)).GT.FLTRNF2(0)) NUMBG = NUMBG + 1
17019c17022
< C Allow 0 Photons to be generated
---
> C Allow 0 Photon2s to be generated
17024,17026c17027,17029
< C       ASSUME ISOTROPIC PHOTON EMISSION IN THE LABORATORY SYSTEM
<          CALL GTISO(U1,V1,W1)
< C       SET THE PHOTON EXIT PARAMETERS
---
> C       ASSUME ISOTROPIC PHOTON2 EMISSION IN THE LABORATORY SYSTEM
>          CALL GTISO2(U1,V1,W1)
> C       SET THE PHOTON2 EXIT PARAMETERS
17032c17035
< C re-sample photon energy depending on model used CZ 13.8.92
---
> C re-sample photon2 energy depending on model used CZ 13.8.92
17034c17037
<             CALL PARTXS(D(LS2),LD(LS2),EOLD,SIGP,EP1)
---
>             CALL PARTXS2(D(LS2),LD(LS2),EOLD,SIGP,EP1)
17038c17041
<             CALL SECEGY(EP1,D(LS3),EOLD,LD(LS3))
---
>             CALL SECEGY2(EP1,D(LS3),EOLD,LD(LS3))
17044,17046c17047,17049
< C       STORE THE PHOTON
<          CALL STOPAR(IDGAMA,NGAMA)
< C end photon production when energy is used up  CZ 13.8.92
---
> C       STORE THE PHOTON2
>          CALL STOPAR2(IDGAMA,NGAMA)
> C end photon2 production when energy is used up  CZ 13.8.92
17051c17054
< 10000 FORMAT(' PHOTON: THE PHOTON PRODUCTION ',
---
> 10000 FORMAT(' PHOTON2: THE PHOTON2 PRODUCTION ',
17055c17058
< 10100 FORMAT(' PHOTON: NO SECONDARY ENERGY ',
---
> 10100 FORMAT(' PHOTON2: NO SECONDARY ENERGY ',
17057c17060
<   390 WRITE(6,*) ' CALOR: ERROR in PHOTON ===> STOP '
---
>   390 WRITE(6,*) ' CALOR: ERROR in PHOTON2 ===> STOP '
17063c17066
<       FUNCTION RNMAXF(T)
---
>       FUNCTION RNMAXF2(T)
17068c17071
<       U=EXPRNF(U)
---
>       U=EXPRNF2(U)
17070,17071c17073,17074
<    10 R1=FLTRNF(0)
<       R2=FLTRNF(0)
---
>    10 R1=FLTRNF2(0)
>       R2=FLTRNF2(0)
17076c17079
<    20 W=EXPRNF(W)/RSQ
---
>    20 W=EXPRNF2(W)/RSQ
17078c17081
<       RNMAXF=(R2SQ*W+U)*T
---
>       RNMAXF2=(R2SQ*W+U)*T
17081c17084
<       RNMAXF=(R1SQ*W+U)*T
---
>       RNMAXF2=(R1SQ*W+U)*T
17086c17089
<       SUBROUTINE SECEGY(EX,FSE,E,IFSE)
---
>       SUBROUTINE SECEGY2(EX,FSE,E,IFSE)
17103c17106
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17133,17134c17136,17137
<       IF(E+CADIG(E).LT.FSE(IP-1))GO TO 60
<       E=E+CADIG(E)
---
>       IF(E+CADIG2(E).LT.FSE(IP-1))GO TO 60
>       E=E+CADIG2(E)
17140c17143
< C       DETERMINE THE INTERPOLATING SCHEME
---
> C       DETERMINE THE INTERP2OLATING SCHEME
17147c17150
<       CALL INTERP(E,P,FSE(IP-3),FSE(IP-2),FSE(IP-1),FSE(IP),IS)
---
>       CALL INTERP2(E,P,FSE(IP-3),FSE(IP-2),FSE(IP-1),FSE(IP),IS)
17198,17202c17201,17205
<       IF(LF.EQ.1)CALL SECLF1(FSE(IP+1),IFSE(IP+1),EX,U,E)
<       IF(LF.EQ.5)CALL SECLF5(FSE(IP+1),IFSE(IP+1),EX,U,E)
<       IF(LF.EQ.7)CALL SECLF7(FSE(IP+1),IFSE(IP+1),EX,U,E)
<       IF(LF.EQ.9)CALL SECLF9(FSE(IP+1),IFSE(IP+1),EX,U,E)
<       IF(LF.EQ.11)CALL SECL11(FSE(IP+1),IFSE(IP+1),EX,U,E)
---
>       IF(LF.EQ.1)CALL SECLF12(FSE(IP+1),IFSE(IP+1),EX,U,E)
>       IF(LF.EQ.5)CALL SECLF52(FSE(IP+1),IFSE(IP+1),EX,U,E)
>       IF(LF.EQ.7)CALL SECLF72(FSE(IP+1),IFSE(IP+1),EX,U,E)
>       IF(LF.EQ.9)CALL SECLF92(FSE(IP+1),IFSE(IP+1),EX,U,E)
>       IF(LF.EQ.11)CALL SECL112(FSE(IP+1),IFSE(IP+1),EX,U,E)
17216c17219
<       SUBROUTINE SECL11(FSE,IFSE,EX,U,E)
---
>       SUBROUTINE SECL112(FSE,IFSE,EX,U,E)
17241,17242c17244,17245
< C       DETERMINE THE INTERPOLATING SCHEME
<       CALL INTSCH(IFSE,I,IS,NR)
---
> C       DETERMINE THE INTERP2OLATING SCHEME
>       CALL INTSCH2(IFSE,I,IS,NR)
17247c17250
<       CALL INTERP(E,A,E1,T1,E2,T2,IS)
---
>       CALL INTERP2(E,A,E1,T1,E2,T2,IS)
17268c17271
<       CALL INTSCH(IFSE(2*NR+2*NE+3),I,IS,NR1)
---
>       CALL INTSCH2(IFSE(2*NR+2*NE+3),I,IS,NR1)
17273c17276
<       CALL INTERP(E,B,E1,T1,E2,T2,IS)
---
>       CALL INTERP2(E,B,E1,T1,E2,T2,IS)
17280c17283
<   100 EX=FISRNF(A,B)
---
>   100 EX=FISRNF2(A,B)
17287c17290
<       SUBROUTINE SECLF1(FSE,IFSE,EX,U,E)
---
>       SUBROUTINE SECLF12(FSE,IFSE,EX,U,E)
17342,17343c17345,17346
< C       DETERMINE THE INTERPOLATING SCHEME
<       CALL INTSCH(IFSE,IE,IS,NRE)
---
> C       DETERMINE THE INTERP2OLATING SCHEME
>       CALL INTSCH2(IFSE,IE,IS,NRE)
17345,17346c17348,17349
<       R=FLTRNF(0)
< C       INTERPOLATION SCHEMES OF 1 (CONSTANT) OR 2 (LINEAR) ALLOWED
---
>       R=FLTRNF2(0)
> C       INTERP2OLATION SCHEMES OF 1 (CONSTANT) OR 2 (LINEAR) ALLOWED
17366c17369
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17369c17372
<          CALL INTSCH(IFSE(IPR),NP,IS,IFSE(IPR))
---
>          CALL INTSCH2(IFSE(IPR),NP,IS,IFSE(IPR))
17386c17389
< 10000 FORMAT(' MICAP: INTERPOLATION SCHEME=',I3,' IN SECLF1')
---
> 10000 FORMAT(' MICAP: INTERP2OLATION SCHEME=',I3,' IN SECLF12')
17389,17390c17392,17393
< 10100 FORMAT(' MICAP: EXIT ENERGY NOT SELECTED IN SECLF1',1P2E13.5)
<   130 WRITE(6,*) ' CALOR: ERROR in SECLF1 =====> STOP '
---
> 10100 FORMAT(' MICAP: EXIT ENERGY NOT SELECTED IN SECLF12',1P2E13.5)
>   130 WRITE(6,*) ' CALOR: ERROR in SECLF12 =====> STOP '
17395c17398
<       SUBROUTINE SECLF5(FSE,IFSE,EX,U,E)
---
>       SUBROUTINE SECLF52(FSE,IFSE,EX,U,E)
17414c17417
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17421,17422c17424,17425
< C       DETERMINE THE INTERPOLATING SCHEME
<       CALL INTSCH(IFSE,I,IS,NR)
---
> C       DETERMINE THE INTERP2OLATING SCHEME
>       CALL INTSCH2(IFSE,I,IS,NR)
17425c17428
<       CALL INTERP(E,THETA,E1,FSE(IP-1),E2,FSE(IP+1),IS)
---
>       CALL INTERP2(E,THETA,E1,FSE(IP-1),E2,FSE(IP+1),IS)
17436c17439
<          CALL INTSCH(IFSE(IPR),I,IS,NR)
---
>          CALL INTSCH2(IFSE(IPR),I,IS,NR)
17463,17464c17466,17467
< 10100 FORMAT(' MICAP: INTERPOLATION SCHEME=',I3,' IN SECLF5')
<       WRITE(6,*) ' CALOR: ERROR in SECLF5 =====> STOP '
---
> 10100 FORMAT(' MICAP: INTERP2OLATION SCHEME=',I3,' IN SECLF52')
>       WRITE(6,*) ' CALOR: ERROR in SECLF52 =====> STOP '
17469c17472
<       SUBROUTINE SECLF7(FSE,IFSE,EX,U,E)
---
>       SUBROUTINE SECLF72(FSE,IFSE,EX,U,E)
17494,17495c17497,17498
< C       DETERMINE THE INTERPOLATING SCHEME
<       CALL INTSCH(IFSE,I,IS,NR)
---
> C       DETERMINE THE INTERP2OLATING SCHEME
>       CALL INTSCH2(IFSE,I,IS,NR)
17498c17501
<       CALL INTERP(E,THETA,E1,FSE(IP-1),E2,FSE(IP+1),IS)
---
>       CALL INTERP2(E,THETA,E1,FSE(IP-1),E2,FSE(IP+1),IS)
17508,17509c17511,17512
<    50 R1=FLTRNF(0)
<       R2=FLTRNF(0)
---
>    50 R1=FLTRNF2(0)
>       R2=FLTRNF2(0)
17513c17516
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17522c17525
<       SUBROUTINE SECLF9(FSE,IFSE,EX,U,E)
---
>       SUBROUTINE SECLF92(FSE,IFSE,EX,U,E)
17547,17548c17550,17551
< C       DETERMINE THE INTERPOLATING SCHEME
<       CALL INTSCH(IFSE,I,IS,NR)
---
> C       DETERMINE THE INTERP2OLATING SCHEME
>       CALL INTSCH2(IFSE,I,IS,NR)
17551c17554
<       CALL INTERP(E,THETA,E1,FSE(IP-1),E2,FSE(IP+1),IS)
---
>       CALL INTERP2(E,THETA,E1,FSE(IP-1),E2,FSE(IP+1),IS)
17561,17562c17564,17565
<    50 R1=FLTRNF(0)
<       R2=FLTRNF(0)
---
>    50 R1=FLTRNF2(0)
>       R2=FLTRNF2(0)
17571c17574
<       SUBROUTINE STOPAR(ID,NP)
---
>       SUBROUTINE STOPAR2(ID,NP)
17616c17619
<       SUBROUTINE TBSPLT(A,E,NP,Y)
---
>       SUBROUTINE TBSPLT2(A,E,NP,Y)
17645c17648
<       SUBROUTINE THRMSC(D,LD,XTHRMS,ITHRMS,LTHRM,E,U,V,W,TEMP,FM,AWR,
---
>       SUBROUTINE THRMSC2(D,LD,XTHRMS,ITHRMS,LTHRM,E,U,V,W,TEMP,FM,AWR,
17671c17674
<       CALL THRSEL(NE,NP7,NB7,E,EOUT,FM,CT,XTHRMS(IIN+5),
---
>       CALL THRSEL2(NE,NP7,NB7,E,EOUT,FM,CT,XTHRMS(IIN+5),
17694,17695c17697,17698
<       IF(PTEST.GT.FLTRNF(0))GO TO 30
<       ETA=-ALOG(FLTRNF(0)*FLTRNF(0))*TDK
---
>       IF(PTEST.GT.FLTRNF2(0))GO TO 30
>       ETA=-ALOG(FLTRNF2(0)*FLTRNF2(0))*TDK
17698c17701
<       ETA=RNMAXF(TDK)
---
>       ETA=RNMAXF2(TDK)
17706c17709
<       CALL GTISO(UN,VN,WN)
---
>       CALL GTISO2(UN,VN,WN)
17711c17714
<       F2=FLTRNF(0)**2
---
>       F2=FLTRNF2(0)**2
17717c17720
<       CALL GTISO(UA,VA,WA)
---
>       CALL GTISO2(UA,VA,WA)
17736c17739
<       SUBROUTINE THRSEL(NE,NP7,NB7,E,EOUT,FM,TDK,ETH,ALPHA,BETA,W,
---
>       SUBROUTINE THRSEL2(NE,NP7,NB7,E,EOUT,FM,TDK,ETH,ALPHA,BETA,W,
17752c17755
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17761c17764
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17770c17773
<      +       'IN 1.0 IN THRSEL',E12.4)
---
>      +       'IN 1.0 IN THRSEL2',E12.4)
17791c17794
<   120 R=FLTRNF(0)
---
>   120 R=FLTRNF2(0)
17798c17801
<      +       'IN 1.0 IN THRSEL',E12.4)
---
>      +       'IN 1.0 IN THRSEL2',E12.4)
17807c17810
<      +       'AT 0.0 IN THRSEL',E12.4)
---
>      +       'AT 0.0 IN THRSEL2',E12.4)
17838c17841
<       R=FLTRNF(0)
---
>       R=FLTRNF2(0)
17855c17858
< 10300 FORMAT(' MICAP: ERROR IN THRSEL, COSINE OF ANGLE >1'/,
---
> 10300 FORMAT(' MICAP: ERROR IN THRSEL2, COSINE OF ANGLE >1'/,
17857c17860
<       FM=2.0*FLTRNF(0)-1.0
---
>       FM=2.0*FLTRNF2(0)-1.0
17862c17865
<       SUBROUTINE TREBOD(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,
---
>       SUBROUTINE TREBOD2(D,LD,KZ1,KZ2,KZ3,A1,A2,A3,Z1,Z2,Z3,
17865c17868
< C processes. This is TWOBOD extended to a third particle
---
> C processes. This is TWOBOD2 extended to a third particle
17917c17920
<          CALL BARIER(KZ1,KZ2,A1,A3,CB)
---
>          CALL BARIER2(KZ1,KZ2,A1,A3,CB)
17919c17922
<          CALL CEVAP(EOLD,Q,ATAR,CB,EX)
---
>          CALL CEVAP2(EOLD,Q,ATAR,CB,EX)
17930c17933
<          CALL GTISO(U1,V1,W1)
---
>          CALL GTISO2(U1,V1,W1)
17968c17971
<          CALL STOPAR(IDHEVY,NHEVY)
---
>          CALL STOPAR2(IDHEVY,NHEVY)
18025c18028
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
18030c18033
<       SUBROUTINE TWOBOD(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,MT)
---
>       SUBROUTINE TWOBOD2(D,LD,KZ1,KZ2,A1,A2,Z1,Z2,ATAR,Q,MT)
18081c18084
<       CALL BARIER(KZ1,KZ2,A1,A2,CB)
---
>       CALL BARIER2(KZ1,KZ2,A1,A2,CB)
18083c18086
<       CALL CEVAP(EOLD,Q,ATAR,CB,EX)
---
>       CALL CEVAP2(EOLD,Q,ATAR,CB,EX)
18097c18100
<          CALL GTISO(U1,V1,W1)
---
>          CALL GTISO2(U1,V1,W1)
18104c18107
<              EKN = E1*FLTRNF(0)
---
>              EKN = E1*FLTRNF2(0)
18147c18150
<          CALL STOPAR(IDHEVY,NHEVY)
---
>          CALL STOPAR2(IDHEVY,NHEVY)
18198c18201
<       CALL STOPAR(IDHEVY,NHEVY)
---
>       CALL STOPAR2(IDHEVY,NHEVY)
18203c18206
<       SUBROUTINE XSECN1(NII,KE,IN,ICOM,IREC,IUNIT,LNUMB,IND,
---
>       SUBROUTINE XSECN12(NII,KE,IN,ICOM,IREC,IUNIT,LNUMB,IND,
18233c18236
<       EQUIVALENCE (D(1),Q(1)),(LD(1),IQ(1))
---
>       EQUIVALENCE (D(1),Q(1)),(LD(1),IQ(1))      
18300c18303
<       SUBROUTINE XSECN2(ICOM,IREC,IUNIT,IGAMS,LGAM,ELTOL,INABS,LNAB,
---
>       SUBROUTINE XSECN22(ICOM,IREC,IUNIT,IGAMS,LGAM,ELTOL,INABS,LNAB,
18352c18355
<           WRITE(IOUT,'(/,'' XSECN2 : Wrong unit number '',I10)') NUNIT
---
>           WRITE(IOUT,'(/,'' XSECN22 : Wrong unit number '',I10)') NUNIT
18371c18374
< 10000 FORMAT('0',10X,'ERROR IN ROUTINE XSECN2, II=',I6,/)
---
> 10000 FORMAT('0',10X,'ERROR IN ROUTINE XSECN22, II=',I6,/)
18491c18494
<           CALL ANGCDF(BUF(LST+1),IBUF(LST+1),LZ)
---
>           CALL ANGCDF2(BUF(LST+1),IBUF(LST+1),LZ)
18502c18505
< C       READ IN THE AVERAGE PHOTON PRODUCTION ARRAY
---
> C       READ IN THE AVERAGE PHOTON2 PRODUCTION ARRAY
18533c18536
< C       READ IN THE PHOTON DATA DICTIONARY (GCB ARRAY)
---
> C       READ IN THE PHOTON2 DATA DICTIONARY (GCB ARRAY)
18543,18544c18546,18547
< C       READ IN ENDF/B FILE12 PHOTON MULTIPLICATION DATA
< C       READ IN ENDF/B FILE13 PHOTON CROSS SECTION DATA
---
> C       READ IN ENDF/B FILE12 PHOTON2 MULTIPLICATION DATA
> C       READ IN ENDF/B FILE13 PHOTON2 CROSS SECTION DATA
18569c18572
< C       READ IN ENDF/B FILE15 PHOTON SECONDARY ENERGY DISTRIBUTIONS
---
> C       READ IN ENDF/B FILE15 PHOTON2 SECONDARY ENERGY DISTRIBUTIONS
18637c18640
<   390 PRINT '('' CALOR: ERROR in XSECN2 ====> STOP '')'
---
>   390 PRINT '('' CALOR: ERROR in XSECN22 ====> STOP '')'
18643c18646
<       SUBROUTINE XSECN3(KM,KE,RHO,IN,IDICTS,LDICT,ISIGTS,LSIGT,BUF,
---
>       SUBROUTINE XSECN32(KM,KE,RHO,IN,IDICTS,LDICT,ISIGTS,LSIGT,BUF,
18733c18736
<             CALL CTERP(BUF(LST+K-1),BUF(LST+K+1),BUF(LST+LZ2+L),
---
>             CALL CTERP2(BUF(LST+K-1),BUF(LST+K+1),BUF(LST+LZ2+L),
18750c18753
<    70       CALL CTERP(BUF(LST+LZ2+L-2),BUF(LST+LZ2+L),BUF(LST+1+K),
---
>    70       CALL CTERP2(BUF(LST+LZ2+L-2),BUF(LST+LZ2+L),BUF(LST+1+K),
18799c18802
<                CALL CTERP(BUF(LST+LP+L-2*KI),BUF(LST+LP+L2),
---
>                CALL CTERP2(BUF(LST+LP+L-2*KI),BUF(LST+LP+L2),
18839c18842
<   190 PRINT '('' CALOR: ERROR in XSECN3 ====> STOP'')'
---
>   190 PRINT '('' CALOR: ERROR in XSECN32 ====> STOP'')'
18845c18848
<       SUBROUTINE XSECN5(NTX,IGCBS,LGCB,IGCBS2,LGCB2,BUF,IBUF,D,LD,
---
>       SUBROUTINE XSECN52(NTX,IGCBS,LGCB,IGCBS2,LGCB2,BUF,IBUF,D,LD,
18847c18850
< C       THIS ROUTINE READS THE PHOTON PARTIAL DISTRIBUTIONS FOR EACH
---
> C       THIS ROUTINE READS THE PHOTON2 PARTIAL DISTRIBUTIONS FOR EACH
18892c18895
< C       SET THE STARTING LOCATION FOR THE PHOTON TOTAL CROSS SECTION
---
> C       SET THE STARTING LOCATION FOR THE PHOTON2 TOTAL CROSS SECTION
18900c18903
< C       ZERO OUT THE CORE AREA TO STORE THE TOTAL PHOTON
---
> C       ZERO OUT THE CORE AREA TO STORE THE TOTAL PHOTON2
18931c18934
<       PRINT '('' CALOR: ERROR in XSECN5 ====> STOP '')'
---
>       PRINT '('' CALOR: ERROR in XSECN52 ====> STOP '')'
18936c18939
<       SUBROUTINE XSECNU(BUF,LEN,E,XSC,L1,L2)
---
>       SUBROUTINE XSECNU2(BUF,LEN,E,XSC,L1,L2)
18959c18962
<       SUBROUTINE MICSET(MATNO,NKEY)
---
>       SUBROUTINE MICSET2(MATNO,NKEY)
19002c19005
<          CALL CHKZEB(NWW,IXCONS)
---
>          CALL CHKZEB2(NWW,IXCONS)
19021c19024
<       CALL CHKZEB(NWW,IXCONS)
---
>       CALL CHKZEB2(NWW,IXCONS)
19028c19031
<       SUBROUTINE MICFIL(CNAME)
---
>       SUBROUTINE MICFIL2(CNAME)
19071,19072c19074,19075
<          CALL CHKZEB(NFIL,IXCONS)
<          CALL MZLINK(IXCONS,'MICFIL',LMIFIL,LMIFIL,LMIFIL)
---
>          CALL CHKZEB2(NFIL,IXCONS)
>          CALL MZLINK(IXCONS,'MICFIL2',LMIFIL,LMIFIL,LMIFIL)
19077c19080
<         CALL CHKZEB(NFIL,IXCONS)
---
>         CALL CHKZEB2(NFIL,IXCONS)
19087c19090
<         PRINT*,' MICSET : invalid file name '
---
>         PRINT*,' MICSET2 : invalid file name '
19696c19699
< C*****CALCULATIONS DEALING WITH SCALED UP NUCLEAR RECOIL AND BPR********
---
> C*****CALCULATIONS DEALING WITH SCALED UP NUCLEAR2 RECOIL AND BPR********
19996c19999
<       DOUBLE PRECISION RANDC
---
>       DOUBLE PRECISION RANDC2
20027c20030
<       T8 = RANDC(ISEED)
---
>       T8 = RANDC2(ISEED)
